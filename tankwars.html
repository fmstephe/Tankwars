<html>
  <head>
	<script type="text/javascript">
	  function init() {
		canvas = document.getElementById("canvas");
		context = canvas.getContext("2d");
		context.fillStyle = "rgba(0,0,0,1.0)";
		context.fillRect(0,0,canvas.width,canvas.height);
		context.strokeStyle = "rgba(100,100,100,1.0)";
		context.moveTo(0,canvas.height/2);
		//var wave1 = makeWave(canvas.width, 0, canvas.width, canvas.height/2)
		//var wave2 = makeWave(canvas.width, 0, canvas.width/4, canvas.height/4)
		//var wave = new Array(canvas.width)
		//addWave(wave1,wave2, wave)
		//normaliseWave(wave, 700, 50)
		wave = generateTerrain(canvas.width, canvas.height)
		for (x = 0; x < wave.length; x++) {
		  context.lineTo(x, canvas.height - wave[x]);
		}
		context.stroke();
		console.log("Reached");
	  }
	  function r(lim) {
		return Math.floor(Math.random()*lim)+1
	  }
	  function generateTerrain(width, height) {
		var wave1 = makeWave(width, width/r(10), width/r(2), height/r(5))
		for (var i = 0; i < 10; i++) {
		  var divisor = r(i)
		  var wave = makeWave(width, width/r(10), width/(divisor*2.5), height/(divisor*5))
		  addWave(wave1, wave);
		}
		normaliseWave(wave1, 700, 50)
		return wave1
	  }
	  function makeWave(len, offset, waveWidth, waveHeight) {
		var wave = new Array(len)
		var widthMult = (Math.PI*2)/waveWidth
		for (i = 0; i < len; i++) {
		  x = (i+offset) * widthMult
		  y = Math.floor(Math.cos(x)*waveHeight)
		  wave[i] = y
		}
		return wave
	  }
	  function addWave(wave1, wave2) {
		for (i = 0; i < wave1.length; i++) {
		  wave1[i] = wave1[i]+wave2[i]
		}
	  }
	  function normaliseWave(wave, upperLim, lowerLim) {
		var max = wave[0];
		for (i = 0; i < wave.length; i++) {
		  if (wave[i] > max)
			max = wave[i];
		}
		var min = wave[0];
		for (i = 0; i < wave.length; i++) {
		  if (wave[i] < min)
			min = wave[i];
		}
		var outMagnitude = upperLim - lowerLim;
		for (i = 0; i < wave.length; i++) {
		  var inMagnitude = (wave[i]-min) / (max-min)
		  wave[i] = (inMagnitude * outMagnitude) + lowerLim
		}
	  }
	</script>
  </head>
  <body onload="init()">
	<div>
	  <canvas id="canvas" width="1800" height="800" border="2"></canvas>
	</div>
  </body>
</html>
